# 05 | 深入浅出索引（下）

这篇文章主要讲了如何同索引进行查询，引入了几个概念。


## 回表

在主键索引上，存储整行数据；在非主键索引上，存储的是索引和主键。如果通过一个非主键索引查询某个值，需要搜索主键索引树，这个过程叫做回表。



## 覆盖索引

索引覆盖是指在查询时，可以直接从索引上查询得到，不需要回表。
这是提升查询性能优化的一个常见手段。

## 联合索引问题

由上面的覆盖索引引出了联合索引的问题：如果经常有根据字段A查询字段B的情况，可以建立字段A和B的联合索引，注意，A在前面。

## 最左前缀原则

索引可以根据最左前缀进行判断，创建联合索引时，可以根据这个原则安排字段顺序。

对于单个字段，创建索引时，可以只创建最左边N位字符。

## 索引下推问题

索引下推 index condition pushdown，是MySQL5.6之后引入的一个优化，对于索引中包含的字段先做判断，直接过滤掉不满足条件的记录，减少回表次数。


## 问题

下面这张表，除了主键索引之外，还有三个索引，问题是，ca和cb这两个联合索引有必要吗？

```
CREATE TABLE `geek` (
  `a` int(11) NOT NULL,
  `b` int(11) NOT NULL,
  `c` int(11) NOT NULL,
  `d` int(11) NOT NULL,
  PRIMARY KEY (`a`,`b`),
  KEY `c` (`c`),
  KEY `ca` (`c`,`a`),
  KEY `cb` (`c`,`b`)
) ENGINE=InnoDB;

```

业务里面有这种情况

```
select * from geek where c=N order by a limit 1;
select * from geek where c=N order by b limit 1;

```

CA有没必要，CB有必要。
我自己分析是C上面的主键自然会找主键索引a,b，但根据最左前缀原则，a能找到，b找不到，所以要有CB索引。
